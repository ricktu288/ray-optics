<!--
  Copyright 2024 The Ray Optics Simulation authors and contributors

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<!DOCTYPE html>
<html lang="zh-TW">

<head>
  <!--
    Copyright 2024 The Ray Optics Simulation authors and contributors
  
    Licensed under the Apache License, Version 2.0 (the "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at
  
        http://www.apache.org/licenses/LICENSE-2.0
  
    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
  -->
  
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>「線光學模擬」模組製作教學 - 線光學模擬</title>
  <meta property="og:title" content="「線光學模擬」模組製作教學 - 線光學模擬">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://phydemo.app/ray-optics/tw/modules/tutorial">
  <meta property="og:image" content="https://phydemo.app/ray-optics/img/image.png">
  <meta property="og:description" content="線光學模擬">
  <meta property="og:locale" content="zh-TW">
  <link rel="canonical" href="https://phydemo.app/ray-optics/tw/modules/tutorial">
  <link rel="alternate" hreflang="en" href="https://phydemo.app/ray-optics/modules/tutorial">
  <link rel="alternate" hreflang="pl" href="https://phydemo.app/ray-optics/pl/modules/tutorial">
  <link rel="alternate" hreflang="pt-BR" href="https://phydemo.app/ray-optics/pt-BR/modules/tutorial">
  <link rel="alternate" hreflang="pt-PT" href="https://phydemo.app/ray-optics/pt-PT/modules/tutorial">
  <link rel="alternate" hreflang="ru" href="https://phydemo.app/ray-optics/ru/modules/tutorial">
  <link rel="alternate" hreflang="ta" href="https://phydemo.app/ray-optics/ta/modules/tutorial">
  <link rel="alternate" hreflang="zh-CN" href="https://phydemo.app/ray-optics/cn/modules/tutorial">
  <link rel="alternate" hreflang="zh-TW" href="https://phydemo.app/ray-optics/tw/modules/tutorial">
  <link rel="stylesheet" href="../../thirdparty/bootstrap/bootstrap.min.css">
  <link rel="icon" href="../../img/icon.png" type="image/png">
  <style>
    .brand {
      font-size: 12pt;
      color: #888;
      margin-top: 0px;
      margin-bottom: 0px;
      margin-left: 5px;
      margin-right: 5px;
      padding: 0px;
      height: 40px;
      line-height: 40px;
      position: relative;
      text-align: center;
      text-decoration: none;
    }
  
    .brand:hover {
      text-decoration: none;
    }
  
    .github-button-container {
      color: #888;
      margin-top: 7px;
      margin-bottom: 0px;
      margin-left: 0px;
      margin-right: 0px;
      padding: 0px;
      height: 40px;
      width: 92px;
      line-height: 40px;
      position: relative;
      text-align: center;
      float: right;
    }
  
    .github-button-container a {
      color: transparent;
    }
  
    .navul {
      font-size: 11pt;
    }
  
    .navul a {
      color: #555;
      float: left;
      margin-top: 0px;
      margin-bottom: 0px;
      margin-left: 5px;
      margin-right: 5px;
      padding: 2px;
      height: 40px;
      line-height: 40px;
      position: relative;
      text-align: center;
      text-decoration: none;
    }
  
    .clearfix {
      clear: both;
    }
  
    .navul a:hover {
      border-bottom: 3px solid #CCC;
      text-decoration: none;
    }
  
    .navul a.active {
      color: #000;
      border-bottom: 3px solid gray;
    }
  
    body {
      padding-top: 72px;
      font-family: system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', 'Liberation Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
    }
  </style>
  <script defer src="../../thirdparty/jquery.min.js"></script>
  <script defer src="../../thirdparty/bootstrap/bootstrap.min.js"></script>
  <script async defer src="https://buttons.github.io/buttons.js"></script>  <style>
    iframe {
      border: none;
      width: 100%;
      height: 400px;
    }
  </style>
</head>

<body>
  <!--
    Copyright 2024 The Ray Optics Simulation authors and contributors
  
    Licensed under the Apache License, Version 2.0 (the "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at
  
        http://www.apache.org/licenses/LICENSE-2.0
  
    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
  -->
  
  <div class="navbar navbar-fixed-top container" style="background-color:white;max-height:90px;overflow:hidden">
  
    <a href="../../tw/" class="navbar-left brand">
      <img src="../../img/icon.png" alt="" style="width:18pt; height:18pt"> 線光學模擬
    </a>
    <div class="navbar-right">
  
      <span class="navul">
        <a href="../../tw/" class="">首頁</a>
        <a href="../../tw/gallery/" class="">作品集</a>
        <a href="../../tw/about" class="">關於</a>
      </span>
      <span class="github-button-container">
        <a class="github-button" href="https://github.com/ricktu288/ray-optics" data-show-count="true"
          aria-label="Star ricktu288/ray-optics on GitHub">Star</a>
      </span>
    </div>
  
  </div>  <div class="container">
    <h1 id="tutorial">「線光學模擬」模組製作教學</h1>
    
    <p>本教學將引導您完成建立自訂模組的基本步驟。這個功能可完全在本模擬器網頁程式中實現，而不需要其他的開發環境。</p>
    <p>「線光學模擬」的「模組」功能允許將物件以模組化的方式組合在一起，其中可包含自訂參數、自訂控制點與物件陣列。本功能透過將本模擬器中現有的工具所建立的物件進行組合、特化或重新參數化，來製作新的工具，以擴充本模擬器的功能。例如，<code>CircleSource</code> 模組（請參見工具-&gt;其他-&gt;匯入模組）將現有的「點光源（&lt;360°）」工具所建立的一系列點光源沿著一個圓形組合在一起，成為一個「圓形光源」工具，這在模擬器中原本並不存在。 <code>FresnelLens</code> 模組則是將「透光物-&gt;自訂函數」工具特化，使函數表示菲涅耳透鏡的特定曲線，由切片數參數化，以製作一個特化的「菲涅耳透鏡」工具，這在模擬器中原本也不存在。除了製作新工具外，這個功能還可以使一些光學演示更具互動性。例如，通過拖曳 <code>BeamExpander</code> 模組的第三個控制點，可以直接觀察兩個透鏡的共同焦點位置如何影響光束寬度，而無需分別調整兩個透鏡的焦距。</p>
    <p>注意並非所有的自訂控制點都需要模組。一些簡單的情況可能可以通過「控制桿」功能實現（請參見模擬器右下角的幫助彈出窗口中的「群組、旋轉和縮放物件」部分）。由於製作模組比建立控制桿複雜得多，您應該在考慮製作模組之前檢查您的情況是否可以通過「控制桿」功能實現。比如<a href="../../tw/gallery/black-cat-becomes-white">這個例子</a>展示了一個相對複雜但不必使用模組的自訂控制點（將兩個塑料袋從水中移開）。</p>
    <p>另一方面，如果您需要進行複雜的編程（例如製作動畫、使用複雜的算法排列光學元件或對輻照度圖進行分析），請改用<a href="https://github.com/ricktu288/ray-optics/tree/dist-integrations">整合工具</a>，並編寫 Python 或 Julia 指令碼。</p>
    <p><b>歡迎將您的模組<a href="https://github.com/ricktu288/ray-optics/blob/master/CONTRIBUTING.md#contributing-modules">貢獻到「匯入模組」清單中</a>！只要您認為這個模組對其他人有幫助，即使是透過 AI 輔助寫成的也可以。</b></p>

    <h2 id="ai-assistant">使用 AI 輔助</h2>
    <p>ChatGPT 上的 <a href="https://chatgpt.com/g/g-6777588b53708191b66722e353e95125-ray-optics-coder">Ray Optics Coder</a> 可以幫助您編寫「線光學模擬」模組。它會根據您的描述生成場景的 JSON 程式碼，您只需要將其複製到 JSON 編輯器（見下）即可。您也可以使用它來編輯現有模組或模組化場景。</p>
    <p>由聊天機器人生成的程式碼可能無法直接運作。如果出現錯誤，建議將錯誤訊息複製到聊天機器人中，可能能夠得到解決。對於更複雜的模組，建議您仍然自行閱讀以下教學並編寫部分程式碼。</p>
    <p>聊天機器人的指引和知識檔案可在<a href="https://github.com/ricktu288/ray-optics/blob/master/ai-tools">這裡</a>取得。如果您偏好其他 LLM 服務，您可以提供這些檔案，教它如何寫出「線光學模擬」模組。</p>

    <h2 id="the-built-in-json-editor">內建的 JSON 編輯器</h2>
    <p>本程式目前沒有用於建立模組的視覺界面，因此您需要直接編輯場景的 JSON 原始碼。</p>
    <p>您可以通過點選網頁介面右上角的「設定」下拉選單，然後勾選「顯示 JSON 編輯器」來啟用內建的 JSON 編輯器。原始碼編輯器會出現在介面的左側，並顯示目前場景的 JSON 原始碼。請確保您有足夠大的螢幕，因為這個功能在行動裝置上效果不佳。</p>
    <p>當您使用視覺化場景編輯器修改場景時，JSON 編輯器中的原始碼將自動更新，且更改的部分會突出顯示。反之，直接在 JSON 編輯器中編輯原始碼將相應更新場景。如果您不熟悉 JSON 或任何基於文字的資料格式，您可能會希望花一些時間來熟悉它。</p>
    <p>特別是，當您將一個物件新增到場景中時，它將被新增到 <code>objs</code> 陣列中。如果您將某些屬性修改為非預設值，它們將作為該物件的鍵值對出現。</p>
    <p>如果您不希望在編輯 JSON 時自動更新場景，您可以啟用設定 -&gt; 顯示模擬器控制列，並取消選擇「自動刷新」。當編輯完成後，點選「刷新模擬」（如果您不希望立即重新運行模擬，也可以點選「刷新場景」）。</p>
    <b><p>注意：如果您在本教學頁面中看不到下面的 iframe 中的 JSON 編輯器，請啟用它並重新載入本頁，因為您需要查看原始碼以了解它的運作方式。</p></b>

    <h2 id="basics-of-a-module">模組的基本概念</h2>
    <p>讓我們看第一個例子。</p>
    <iframe loading="lazy" src="../../simulator/?zh-TW#../tw/gallery/module-example-basics"></iframe>
    <p>您會看到四段文字。通過查看 JSON 編輯器，您將看到前兩段直接位於頂層的 <code>objs</code> 陣列中，但後兩段位於 <code>modules.ExampleModule.objs</code> 中。</p>
    <p><code>modules</code> 是一個字典，其中鍵是模組的名稱（在本例中是 <code>ExampleModule</code>），值是該模組的定義。特別是，<code>modules.ExampleModule.objs</code> 陣列描述了該模組中的物件（模板），這與描述場景中的物件的頂層 <code>objs</code> 陣列不同。</p>
    <p>要將模組中的物件放到場景中，我們需要一個「模組物件」，它位於頂層 <code>objs</code> 陣列中，本例中是 <code>objs[2]</code>，其類型是 <code>ModuleObj</code>，其 <code>module</code> 屬性是模組的名稱。</p>
    <p><code>modules</code> 字典中的模組定義無法由視覺化場景編輯器編輯。因此，當您點選本例中的後兩段文字時，您只選擇了模組物件，而不是模組中的物件。由於本例中模組定義中的文字座標是絕對座標，因此後兩段文字無法被拖曳。我們將在後面學習到如何使用控制點來使它們可被拖曳。</p>
    <p>當您選取模組物件時，物件欄上會有一個「取消模組化」按鈕。點選後會將模組物件「展開」為構成此模組的物件，此時 <code>objs</code> 將包含所有四段文字。這個操作是不可逆的（除非按「復原」）。</p>
    <p>目前建議製作模組的方式為，首先使用 JSON 編輯器建立一個空的模組，然後使用視覺化場景編輯器新增一些物件，最後使用 JSON 編輯器將這些物件從 <code>objs</code> 剪下並貼上到 <code>modules.ModuleName.objs</code> 中。</p>

    <h2 id="adding-parameters">新增參數</h2>
    <p>模組中的物件可以由一組參數來定義。讓我們看一個簡單的例子</p>
    <iframe loading="lazy" src="../../simulator/?zh-TW#../tw/gallery/module-example-parameters"></iframe>
    <p>這裡 <code>modules.ModuleName.params</code> 是一個由形如 <code>&quot;名稱=起始值:增量:終止值:預設值&quot;</code>的字串構成的陣列，定義了變數的名稱和數值滑桿的範圍。當選取模組物件時，滑桿將出現在物件欄上。</p>
    <p>在 <code>modules.ExampleModule.objs</code> 陣列中，任何值都可以使用這些參數來表示。在字串中（例如 <code>TextLabel</code> 的 <code>text</code> 屬性）中，帶有參數的數學式被反引號包圍。對於數值參數（例如 <code>TextLabel</code> 的 <code>fontSize</code> 屬性），您需要將其改為字串，以便您可以在其中使用反引號格式。因此每條數學式都被一對反引號和一對引號包圍。這些數學式將使用 math.js 來計算（<a href="https://mathjs.org/docs/reference/functions/evaluate.html">語法</a>）。請參見該網頁以了解您可以在數學式中使用的語法和函數。</p>
    <p>參數的實際值位於模組物件的 <code>params</code> 屬性中。這部分與模組定義不同，其可以通過滑桿直接由視覺化場景編輯器編輯。</p>

    <h2 id="adding-control-points">新增控制點</h2>
    <p>為了使模組物件可被拖曳，我們需要使用一組控制點來對模組中的物件位置進行參數化。讓我們看一個例子</p>
    <iframe loading="lazy" src="../../simulator/?zh-TW#../tw/gallery/module-example-control-points"></iframe>
    <p>這裡 <code>modules.ModuleName.numPoints</code> 描述了控制點的數量。控制點座標之符號為 (<code>x_1</code>, <code>y_1</code>)、(<code>x_2</code>, <code>y_2</code>) 等等。其用在 <code>modules.ExampleModule.objs</code> 中的方式與前一節所述之參數相同。請注意索引從 1 開始。</p>
    <p>控制點的實際值位於模組物件的 <code>controlPoints</code> 屬性中，其可以直接由視覺化場景編輯器編輯，而非如第一個例子中寫死在模組定義中的座標。每個控制點在場景中顯示為兩個同心的灰色圓形，並且可以被拖曳。若您拖曳模組物件的其他地方（如文字標籤），則所有的控制點會一起移動。</p>
    <p>由於我們的模組物件已經可以移動，我們可以很容易地建立多個實例，就像在本模擬器中其他的工具中一樣。模組的名稱顯示在工具-&gt;其他選單中，您可以選擇它，然後按兩個點來指定兩個控制點的位置，就可建立此模組的另一個實例。您也可以使用物件欄上的「複製」按鈕。</p>

    <h2 id="arrays-and-conditionals">陣列與條件</h2>
    <p>使用陣列和條件語法，可以建立更複雜的模組。讓我們看一個例子</p>
    <iframe loading="lazy" src="../../simulator/?zh-TW#../tw/gallery/module-example-arrays-and-conditionals"></iframe>
    <p>在 <code>modules.ExampleModule.objs</code> 中，任何陣列中的物件都可以有兩個特殊的鍵： <code>&quot;for&quot;</code> 和 <code>&quot;if&quot;</code>。 <code>&quot;for&quot;</code> 鍵的值是一個描述迴圈變數的字串，格式為 <code>&quot;名稱=起始值:增量:終止值&quot;</code>，或者是一個包含多個這種格式的字串的陣列，描述多維迴圈。這樣的物件在陣列中根據迴圈變數被複製多次。<code>&quot;if&quot;</code> 鍵的值是則是一個表示布林值的字串，使得該物件只在布林值為真時才會包含在陣列中。</p>
    <p>為了防止意外的無窮迴圈，每個 <code>&quot;for&quot;</code> 迴圈的總迭代次數由模組定義中的 <code>maxLoopLength</code> 屬性限制，其預設值為 1000。如果需要，您可以將此屬性設定為更大的值。</p>

    <h2 id="using-variables">使用變數</h2>
    <p>您可以定義數學變數和函數，以便在整個模組中使用。讓我們看一個例子</p>
    <iframe loading="lazy" src="../../simulator/?zh-TW#../tw/gallery/module-example-variables"></iframe>
    <p><code>modules.ModuleName.vars</code> 是一個字串陣列，每個字串代表一個 math.js 陳述式，其定義一個變數或函數。這些定義按序求值，因此後面的定義可以引用前面定義的變數。</p>
    <p>變數定義可以引用所有參數和控制點座標，且被定義後，這些變數可以像參數和控制點座標一樣在物件模板中被引用，從而實現更複雜和可重用的計算。</p>

    <h2 id="objects-with-built-in-custom-equations">內建自訂數學式功能的物件</h2>
    <p>對於已經具有自訂數學式輸入的物件（例如鏡子 -&gt; 自訂函數），JSON 中的數學式屬性是一個表示 LaTeX 數學式的字串。要使用 math.js 來表達這種數學式，並引用模組參數等，您需要將 math.js 表達式夾在在雙反引號中。這種區塊會展開為包含自由變數（如 \(x\) 對應 <code>x</code>，\(\theta_0\) 對應 <code>theta_0</code>）的 LaTeX 數學式。這與單反引號區塊不同，單反引號區塊不可包含自由變數，且會展開為一個數值。以下例子中，自訂方程式鏡子使用了一個包含自訂參數 <code>phi</code> 的數學式</p>
    <iframe loading="lazy" src="../../simulator/?zh-TW#../tw/gallery/module-example-custom-equation"></iframe>
    <p>雖然您可以在變數和單反引號區塊中使用任何 math.js 語法和運算，在雙反引號區塊中，您只能使用目標物件的數學式輸入方塊所支援的常數、運算子和函數在 math.js 中的對應（請參見目標物件的資訊框）。您可以使用 <code>vars</code> 陣列中定義的函數，但函數定義最終也必須由支援的運算組成。</p>
    <p>隱式乘法（例如 <code>2x</code>）在這種情況下也不允許使用，因為在 math.js 中隱式乘法的運算子優先級沒有明確定義。請使用 <code>*</code> 運算子明確地表示乘法（例如 <code>2*x</code>）。</p>

    <h2 id="objects-with-built-in-shape-parametrization">內建形狀參數化功能的物件</h2>
    <p>對於已經支援使用不同方式定義其形狀的物件（目前僅有透光物 -&gt; 球面透鏡），有特殊的 JSON 語法可用於在模組定義中用這些方式來定義該物件，即使在頂層 <code>objs</code> 陣列中這類的物件總是以形狀來定義。以下是一個例子</p>
    <iframe loading="lazy" src="../../simulator/?zh-TW#../tw/gallery/module-example-shape-parametrization"></iframe>

    <!--
      Copyright 2024 The Ray Optics Simulation authors and contributors
    
      Licensed under the Apache License, Version 2.0 (the "License");
      you may not use this file except in compliance with the License.
      You may obtain a copy of the License at
    
          http://www.apache.org/licenses/LICENSE-2.0
    
      Unless required by applicable law or agreed to in writing, software
      distributed under the License is distributed on an "AS IS" BASIS,
      WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
      See the License for the specific language governing permissions and
      limitations under the License.
    -->
    
    <div style="float: right; padding-bottom: 1em;">
      <div class="dropup">
        <button class="btn btn-default dropdown-toggle" type="button" data-toggle="dropdown">
          <span id="language">語言：正體中文</span>
          <span class="caret"></span>
        </button>
        <ul class="dropdown-menu">
          <li><a href="../../modules/tutorial">English<span style="color:gray"></span></a></li>
          <li><a href="../../pl/modules/tutorial">polski<span style="color:gray"></span></a></li>
          <li><a href="../../pt-BR/modules/tutorial">Português (Brasil)<span style="color:gray"></span></a></li>
          <li><a href="../../pt-PT/modules/tutorial">Português (Portugal)<span style="color:gray"></span></a></li>
          <li><a href="../../ru/modules/tutorial">Русский<span style="color:gray"></span></a></li>
          <li><a href="../../ta/modules/tutorial">தமிழ்<span style="color:gray"></span></a></li>
          <li><a href="../../cn/modules/tutorial">简体中文<span style="color:gray"></span></a></li>
          <li><a href="../../tw/modules/tutorial">正體中文<span style="color:gray"></span></a></li>
        </ul>
      </div>
    </div>  </div>

  <script id="MathJax-script" async src="../../thirdparty/mathjax/tex-mml-chtml.js"></script>
</body>

</html>